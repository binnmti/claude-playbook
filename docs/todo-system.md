# ToDoシステム

シンプルなタスク管理の仕組み。

## コマンド

| コマンド | 説明 |
|---------|------|
| `/todo` | やりたいことを伝えてToDoリストに追加 |
| `/todo-run` | タスクを実行 |
| `/todo-run all` | 全タスクを自走式で実行 |

## ファイル構造（プロジェクトごと）

```
doc/todos/
├── todo.md     ← 普段見るのはここだけ
├── done.md     ← 完了後の確認用
└── tasks/      ← Claude用（ほぼ見ない）
    └── task-xx/
        └── plan.md
```

※ `/todo` 初回実行時に自動生成される

## タスクの書き方

**基本**: やりたいことをシンプルに1行で書く
**詳細が必要な場合**: 階層（インデント）を使って説明を追加

```markdown
## ToDo
- [ ] 認証機能を追加する              ← シンプルに1行でもOK
- [ ] ログ出力を改善する
  - 現状のログレベルを見直す          ← 詳細が必要なら階層で追加
  - エラーログにスタックトレースを含める
    - 本番環境では省略する            ← さらに詳細があれば孫階層も可
```

**関連するものは1タスクにまとめ**、**関連しないものは別タスクに分ける**。

## 使い方

### 1. ToDoを追加

```
/todo
```
→ 会話でやりたいことを伝える
→ 方向性確認（手作業の有無を含む）
→ todo.md + plan.md が作成される

または、直接 todo.md を編集してもOK。

### 2. タスクを実行

```
/todo-run
```
→ ToDoの先頭から実行 → Worktreeで作業 → 完了報告

### 3. 確認してマージ

```
.worktrees/task-xx/ で動作確認
→ 「マージして」と伝える
```

## todo.md の見方

```markdown
## ToDo      ← 未着手
## Doing     ← 進行中
## Done      ← 完了
```

## 困ったとき

| 状況 | 見る場所 |
|------|---------|
| 何をすればいいか分からない | done.md の「次のアクション」 |
| 何をやったか分からない | done.md の「やったこと」 |
| 詳細な実装内容を知りたい | tasks/task-xx/plan.md |

## Worktree

各タスクは独立したWorktreeで作業される。

```
.worktrees/
├── task-01-認証/     ← ここで確認
└── task-02-ログ/     ← ここで確認
```

- ブランチ切り替え不要で確認できる
- 確認後に「マージして」でmainに統合

## 特徴

| 項目 | 内容 |
|------|------|
| コンテキスト分離 | サブエージェントで実行、長時間でも安定 |
| クイックレビュー | 各タスク完了後に自動レビュー |
| ファイナルレビュー | 全完了後にまとめてレビュー |
| 早期軌道修正 | 2回失敗で停止、ユーザーに相談 |
| 自走式 | `/todo-run all` で確認なしで進行 |
| 手作業の事前検討 | 自律実行を妨げる手作業を最小化 |

## 手作業について

自律実行中に手作業が発生すると止まる。

**`/todo` 段階で:**
- 手作業が必要か事前に検討
- 手作業なしで済む方法を提案
- どうしても必要な場合は最初に伝える

## /plan 系との使い分け

| 用途 | コマンド |
|------|---------|
| 日常的なタスク | `/todo` + `/todo-run` |
| 大規模リファクタ、設計記録を残したい | `/plan` + `/plan-run` |
